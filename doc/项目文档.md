# 项目文档

### 模块逻辑关系

​	设计类的时候主要考虑到两个方面，一是逻辑与UI分离，二是类的设计要面向对象。因此我的类的设计分为三部分：logic，show和interaction，分别处理逻辑、UI与两者的交互。所有的逻辑类有一个共同的基类Abstract Logic，所有的UI类有一个基类Abstract Show，所有的交互类有一个Abstract Interaction类，因此要实现一个功能，比如说选卡组（Choose Card Group）的功能，一个典型的实现就是，Logic Choose Card Group + Show Choose Card Group + Interaction Choose Card Group。这里面要提到的是，Interaction类的主要功能是connect（事实上，Interaction类的内部都是connect与QSignalMapper）。

### 程序运行流程

​	首先，在调用Main Window构造函数的时候，程序就会把所有需要的类的对象new出来，等以后用的时候就调出来用，先进入ShowMainMenu，显示开始界面（背景是style sheet），点击play按钮之后，程序就会自动进入监听模式，去监听与外部相连的2017端口，也就是说在P2P对战中，两边的程序都默认是服务端，当用户把IP地址填入，点击connect按钮之后，这个程序就会变成客户端，与对应IP的2017端口进行连接。

​	这里要提醒一下助教，如果是在同一台电脑上测试的话，由于默认是2017端口，因此会发生冲突，我特地修改了端口，做了两份程序提交了上去，一个监听本机2017端口，connect时会连接对应IP的2016端口，另一个正相反，方便助教在同一台电脑上测试。

​	连接好之后，进入选卡组界面，点击表示选中了卡组，然后进入调度阶段，选好之后点击按钮表示完成，然后等待对方选好，都选好之后，双方同时进入，进入前，作为服务端的程序会产生一个随机数来判断先后手。

​	进入游戏，出牌的一方先点击自己的牌，然后再选择放置位置，选择位置的方法如下：点击该排的某一张牌，就会打到该牌的右侧，如果这一排没有牌或者想放到所有牌的最左边，就点击排首的按钮。双方交替出牌，最后点数大的获胜。

​	游戏有胜、负、平局三种，在每一轮结束时，结算按钮处会显示上一局的对局情况，等双方都调度结束，点击按钮之后，就会同时进入下一轮。

​	游戏三局两胜，如果前两局一方获胜，则游戏直接结束。

​	提示：1.在调度阶段多次点击按钮会导致发送多次信号。2.在对局进行过程中退出程序，程序中的eventloop还在执行，会导致程序不正常退出，退出可以在游戏结束的时候或者开始之前退出。

### 功能及其演示流程

​	实现的功能有，逻辑方面：网络对战、选卡组、调度、游戏流程（除卡牌效果），计算点数并结算。UI方面，使用的Layout布局，背景使用了style sheet，游戏结束的动画用到了QAnimation。

### 参考文献

​	QT 5.9 官方文档